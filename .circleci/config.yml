# Use the latest 2.1 version of CircleCI pipeline process engine.
# See: https://circleci.com/docs/2.0/configuration-reference
version: 2.1
orbs: 
  kubernetes: circleci/kubernetes@1.3.1
# Define a job to be invoked later in a workflow.
# See: https://circleci.com/docs/2.0/configuration-reference/#jobs
jobs:
  create-update:
    docker:
      - image: 'cimg/base:stable'
    steps:
      - checkout
      - kubernetes/install-kubectl
      - kubernetes/install-kubeconfig:
          kubeconfig: YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VKa2FrTkRRVkl5WjBGM1NVSkJaMGxDUVVSQlMwSm5aM0ZvYTJwUFVGRlJSRUZxUVdwTlUwVjNTSGRaUkZaUlVVUkVRbWh5VFROTmRHTXlWbmtLWkcxV2VVeFhUbWhSUkVVeVRtcEJNVTFFVlhkT2FrMTNTR2hqVGsxcVNYZFBSRVV3VFZScmVVNUVTWHBYYUdOT1RYcEpkMDlFUlhoTlZHdDVUa1JKZWdwWGFrRnFUVk5GZDBoM1dVUldVVkZFUkVKb2NrMHpUWFJqTWxaNVpHMVdlVXhYVG1oUlJFVXlUbXBCTVUxRVZYZE9hazEzVjFSQlZFSm5ZM0ZvYTJwUENsQlJTVUpDWjJkeGFHdHFUMUJSVFVKQ2QwNURRVUZTTkZsVlZURXliMEprT0ROVmRuTkVXa0ZJWTJOaFlWRXlLMkZRUVdFeVZraDJPRmhUVjB0cWFEY0tRU3RHYTJRcllVVjZPRWR3UVRaMWFubDVWR0prZWs1amVGRkllVUpKV2xoVmRVNHhSUzlJV25sTlUzZHZNRWwzVVVSQlQwSm5UbFpJVVRoQ1FXWTRSUXBDUVUxRFFYRlJkMFIzV1VSV1VqQlVRVkZJTDBKQlZYZEJkMFZDTDNwQlpFSm5UbFpJVVRSRlJtZFJWVlkzYUVac1pVZFhNMlJ3WjFjeU9ISnpTamhtQ2xKM1p6bEljMEYzUTJkWlNVdHZXa2w2YWpCRlFYZEpSRkozUVhkU1FVbG5WMlJUTjB4VmIyUm1ORU0yY2tkVWFUZFdjRWhGVGpGRGFESlNaREpsV0hrS1VrWlNaMFJWTmxkQ2JEQkRTVU5EVWpBelIxYzBiR1ozZERsVGRqZG5XR0ZMWldWNFNYUXhlSGx1VDNaNldHeFBaaTltV0hkamNsRUtMUzB0TFMxRlRrUWdRMFZTVkVsR1NVTkJWRVV0TFMwdExRbz0KICAgIHNlcnZlcjogaHR0cHM6Ly8xMjcuMC4wLjE6NjQ0MwogIG5hbWU6IGRlZmF1bHQKY29udGV4dHM6Ci0gY29udGV4dDoKICAgIGNsdXN0ZXI6IGRlZmF1bHQKICAgIHVzZXI6IGRlZmF1bHQKICBuYW1lOiBkZWZhdWx0CmN1cnJlbnQtY29udGV4dDogZGVmYXVsdApraW5kOiBDb25maWcKcHJlZmVyZW5jZXM6IHt9CnVzZXJzOgotIG5hbWU6IGRlZmF1bHQKICB1c2VyOgogICAgY2xpZW50LWNlcnRpZmljYXRlLWRhdGE6IExTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVUpyVkVORFFWUmxaMEYzU1VKQlowbEpUWFJKTVRFMFEwTmlkVzkzUTJkWlNVdHZXa2w2YWpCRlFYZEpkMGw2UldoTlFqaEhRVEZWUlVGM2Qxa0tZWHBPZWt4WFRuTmhWMVoxWkVNeGFsbFZRWGhPYWxsM1RsUkJNVTFFV1hwTlFqUllSRlJKZVUxRVozaE9SRVUxVFdwUmVVMHhiMWhFVkVsNlRVUm5lQXBPUkVVMVRXcFJlVTB4YjNkTlJFVllUVUpWUjBFeFZVVkRhRTFQWXpOc2VtUkhWblJQYlRGb1l6TlNiR051VFhoR1ZFRlVRbWRPVmtKQlRWUkVTRTQxQ21NelVteGlWSEJvV2tjeGNHSnFRbHBOUWsxSFFubHhSMU5OTkRsQlowVkhRME54UjFOTk5EbEJkMFZJUVRCSlFVSkpRM1JuZEU5bFptdzRjblI2WmpjS2IweEdMMmhNZDNoaGJIWmxibk52YjBKRGRYZDRUR1pPY1d4TFdYbEhXbEpZYTJWRGRrUXpjMHQzZDFwalFTODROV1JpYlVVMUwwSnJaekJqUTNRd2JRcHhVbGszV1RGeGFsTkVRa2ROUVRSSFFURlZaRVIzUlVJdmQxRkZRWGRKUm05RVFWUkNaMDVXU0ZOVlJVUkVRVXRDWjJkeVFtZEZSa0pSWTBSQmFrRm1Da0puVGxaSVUwMUZSMFJCVjJkQ1VTOU5XRVoxTTFONlUwRjRjVVI2TDFrcmRXVXJTbFZNYjBwUFZFRkxRbWRuY1docmFrOVFVVkZFUVdkT1NVRkVRa1lLUVdsRlFXaE5hMHN5TVZJNWQycFNWMEYzUldWS2IzazBRVTE1ZVM5dmEyZzVOamxTZFdKd2VUTkthQzl2TmpSRFNVSmtXV3QzTlZKS1UyNTBlRmRTVUFwdU0wNTRjRTFFTVd0dVNrWnJOVGhGZDFaV1oxSXhSR2RyYjBORUNpMHRMUzB0UlU1RUlFTkZVbFJKUmtsRFFWUkZMUzB0TFMwS0xTMHRMUzFDUlVkSlRpQkRSVkpVU1VaSlEwRlVSUzB0TFMwdENrMUpTVUprZWtORFFWSXlaMEYzU1VKQlowbENRVVJCUzBKblozRm9hMnBQVUZGUlJFRnFRV3BOVTBWM1NIZFpSRlpSVVVSRVFtaHlUVE5OZEZreWVIQUtXbGMxTUV4WFRtaFJSRVV5VG1wQk1VMUVWWGRPYWsxM1NHaGpUazFxU1hkUFJFVXdUVlJyZVU1RVNYcFhhR05PVFhwSmQwOUVSWGhOVkd0NVRrUkplZ3BYYWtGcVRWTkZkMGgzV1VSV1VWRkVSRUpvY2swelRYUlpNbmh3V2xjMU1FeFhUbWhSUkVVeVRtcEJNVTFFVlhkT2FrMTNWMVJCVkVKblkzRm9hMnBQQ2xCUlNVSkNaMmR4YUd0cVQxQlJUVUpDZDA1RFFVRlJLMGx3VVhOd2JrRnZTV05TVlhsQ2N6QklUbUZqTTFSV1FqWlRNQ3RIYjBRMGFITlNTVUpXWjA4S1VGRkdSakV6Y0VRMldYUnpXRGxMUkU5NWJXbGxiR056UzNoa1VVUkJVRTFGY2pSTE1FWlFaUzlFTURadk1FbDNVVVJCVDBKblRsWklVVGhDUVdZNFJRcENRVTFEUVhGUmQwUjNXVVJXVWpCVVFWRklMMEpCVlhkQmQwVkNMM3BCWkVKblRsWklVVFJGUm1kUlZWQjZSbmhpZERCek1HZE5ZV2M0THpKUWNtNTJDbWxXUXpaRFZHdDNRMmRaU1V0dldrbDZhakJGUVhkSlJGTkJRWGRTVVVsb1FVbEtlSEZMV1RoVEt6aHZTVzVRZFVKVGRtUXZiVmxFVW1oMFdHZENNM2NLV0dkNFpXcGtTaXRPZUVwM1FXbEJWV3Q2S3pFeGJXeFFUMHMzZFRrdmNVRXZVbWRhZVROSFIwMVpRV3hPTjJwMFlVMUdjR2x0U0habVp6MDlDaTB0TFMwdFJVNUVJRU5GVWxSSlJrbERRVlJGTFMwdExTMEsKICAgIGNsaWVudC1rZXktZGF0YTogTFMwdExTMUNSVWRKVGlCRlF5QlFVa2xXUVZSRklFdEZXUzB0TFMwdENrMUlZME5CVVVWRlNVTlNUMkpVYWt0YWJFZE1RVk5pUkZobk5qUllWQ3R3UW1weE1VdEZWV1JSVlVnNGJWVXJLemhaTkN0dlFXOUhRME54UjFOTk5Ea0tRWGRGU0c5VlVVUlJaMEZGWjBzeVF6QTFOU3RZZVhVelRpOTFaM05ZSzBWMlJFWnhWemsyWlhscFowVkxOMFJGZERneWNWVndha2xhYkVabFVqUkxPQXBRWlhkeVJFSnNkMFF2ZW13eGRWbFViamhIVTBSU2Qwc3pVMkZ3Um1wMGFsZG5QVDBLTFMwdExTMUZUa1FnUlVNZ1VGSkpWa0ZVUlNCTFJWa3RMUzB0TFFvPQo=      
      - kubernetes/create-or-update-resource:
          get-rollout-status: true
          resource-file-path: deployment.yml
          resource-name: deployment/whoami2
          show-kubectl-command: true

workflows:
    "Hello Workflow":
        jobs:
          - create-update
